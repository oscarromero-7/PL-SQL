SET SERVEROUTPUT ON;
DECLARE
	DIVISION_X_CERO EXCEPTION;
	PRAGMA EXCEPTION_INIT (DIVISION_X_CERO, -1476);
	V_ACTIVOS B_MAYOR.ACUM_DEBITO%TYPE;
	V_PASIVOS B_MAYOR.ACUM_CREDITO%TYPE;
BEGIN
	SELECT 
		SUM(CASE WHEN M2.CODIGO_CTA BETWEEN 1000000 AND 1999999 THEN (M2.ACUM_DEBITO - M2.ACUM_CREDITO) ELSE 0 END) AS SALDO_DEUDOR,
		SUM(CASE WHEN M2.CODIGO_CTA BETWEEN 2000000 AND 2999999 THEN (M2.ACUM_CREDITO - M2.ACUM_DEBITO) ELSE 0 END) AS SALDO_ACREEDOR
	INTO 
		V_ACTIVOS, V_PASIVOS
	FROM B_MAYOR M2;
	DBMS_OUTPUT.PUT_LINE('SALDO ACTIVOS: ' ||V_ACTIVOS ||' SALDO PASIVOS: '||V_PASIVOS );
	--IF V_PASIVOS <> 0 THEN
		DBMS_OUTPUT.PUT_LINE('ACTIVO / PASIVO: ' || V_ACTIVOS / V_PASIVOS);
	--ELSE
	--	RAISE DIVISION_X_CERO;
	--END IF;
	
EXCEPTION 
	WHEN DIVISION_X_CERO THEN
		DBMS_OUTPUT.PUT_LINE('Se intenta dividir por cero.');
END;
/
