SET SERVEROUTPUT ON;
DECLARE
	CURSOR C_TODAS_TABLAS IS 
		SELECT TABLE_NAME 
		FROM ALL_TABLES
		WHERE UPPER(OWNER) = 'BASEDATOS2';
	CURSOR C_TODAS_COLUMNAS (NOMB_TABLA ALL_TABLES.TABLE_NAME%TYPE) IS
		SELECT 	COLUMN_NAME,
			DATA_TYPE,
			DATA_LENGTH,  
			NULLABLE
		FROM USER_TAB_COLUMNS
		WHERE TABLE_NAME = NOMB_TABLA;
	R_COLUMNAS C_TODAS_COLUMNAS%ROWTYPE;
	V_ERROR_CODE NUMBER;
    V_ERROR_MESSAGE VARCHAR2(255);
BEGIN
	BEGIN
		FOR R_TABLAS IN C_TODAS_TABLAS LOOP
			DBMS_OUTPUT.PUT_LINE('TABLA: '|| R_TABLAS.TABLE_NAME);
			BEGIN
				OPEN C_TODAS_COLUMNAS(R_TABLAS.TABLE_NAME);
					FETCH C_TODAS_COLUMNAS INTO R_COLUMNAS;
					IF C_TODAS_COLUMNAS%FOUND THEN
						WHILE C_TODAS_COLUMNAS%FOUND LOOP
							DBMS_OUTPUT.PUT_LINE('	NOMBRE_COLUMNA: '||R_COLUMNAS.COLUMN_NAME||' TIPO_DATO: '||R_COLUMNAS.DATA_TYPE||' DATA_LENGTH: '||R_COLUMNAS.DATA_LENGTH||' NULLABLE?: '||R_COLUMNAS.NULLABLE);
							FETCH C_TODAS_COLUMNAS INTO R_COLUMNAS;
						END LOOP;
					ELSE
						DBMS_OUTPUT.PUT_LINE('	NO SE ENCONTRÃ“ COLUMNAS ');
					END IF;
				CLOSE C_TODAS_COLUMNAS;
			END;
		
		END LOOP;
	
	END;
EXCEPTION
	WHEN OTHERS THEN
        V_ERROR_CODE := SQLCODE;
        V_ERROR_MESSAGE := SQLERRM;
        DBMS_OUTPUT.PUT_LINE (TO_CHAR(V_ERROR_CODE)||': '|| V_ERROR_MESSAGE);
END;
/