DECLARE
	TYPE E_ESTADISTICA_V IS RECORD (
		MES VARCHAR2(20),
		TOTAL_VENTAS NUMBER,
		VOLUMEN_VENTAS NUMBER
	);
	TYPE ESTADISTICA_V IS TABLE OF E_ESTADISTICA_V INDEX BY BINARY_INTEGER;
	T_ESTADISTICA_V ESTADISTICA_V;
BEGIN
	SELECT
		CASE EXTRACT(MONTH FROM V.FECHA)
			WHEN 01 THEN 'ENERO'
			WHEN 02 THEN 'FEBRERO'
			WHEN 03 THEN 'MARZO'
			WHEN 04 THEN 'ABRIL'
			WHEN 05 THEN 'MAYO'
			WHEN 06 THEN 'JUNIO'
			WHEN 07 THEN 'JULIO'
			WHEN 08 THEN 'AGOSTO'
			WHEN 09 THEN 'SEPTIEMBRE'
			WHEN 10 THEN 'OCTUBRE'
			WHEN 11 THEN 'NOVIEMBRE'
			WHEN 12 THEN 'DICIEMBRE'
		END AS MES,
		SUM(DV.CANTIDAD * DV.PRECIO) AS TOTAL_VENTAS,
		COUNT(V.ID) AS TOTAL_CANTIDAD
	BULK COLLECT INTO T_ESTADISTICA_V
	FROM 
		B_VENTAS V
	INNER JOIN 
		B_DETALLE_VENTAS DV ON V.ID = DV.ID_VENTA
	WHERE 
		EXTRACT(YEAR FROM V.FECHA) = 2018
	GROUP BY 
		EXTRACT(MONTH FROM V.FECHA);
	FOR I IN 1 .. T_ESTADISTICA_V.COUNT LOOP
		DBMS_OUTPUT.PUT_LINE('MES:' || T_ESTADISTICA_V(I).MES || ' TOTAL VENTAS:'||TO_CHAR(T_ESTADISTICA_V(I).TOTAL_VENTAS,'999G999G999') || ' VOLUMEN VENTAS: ' || T_ESTADISTICA_V(I).VOLUMEN_VENTAS);
	END LOOP;
	DBMS_OUTPUT.PUT_LINE('LONGITUD VECTOR: '||T_ESTADISTICA_V.COUNT); 
END;
/