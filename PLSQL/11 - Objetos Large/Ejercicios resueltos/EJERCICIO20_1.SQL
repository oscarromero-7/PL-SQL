ALTER TABLE B_EMPLEADOS
ADD FOTOBLOB BLOB;
--ACTUALIZAR UN BLOB
DECLARE
	NOMBRE_ARCHIVO VARCHAR2(100);
	CURSOR C_EMPLEADOS IS
		SELECT 
			CEDULA 
		FROM B_EMPLEADOS 
		FOR UPDATE;
	ARCHIVO BFILE;
	V_FOTOBLOB BLOB;
BEGIN
	FOR REG IN C_EMPLEADOS LOOP
		NOMBRE_ARCHIVO:= TRIM(BOTH FROM TO_CHAR(REG.CEDULA)) || '.jpg';
		ARCHIVO := BFILENAME('MIS_BLOBS',NOMBRE_ARCHIVO);
		IF DBMS_LOB.FILEEXISTS(ARCHIVO) = 1 THEN 
		    DBMS_LOB.FILEOPEN(ARCHIVO);
			
			DBMS_LOB.CREATETEMPORARY(V_FOTOBLOB, TRUE, DBMS_LOB.CALL);
			--crea un LOB temporal que puede usarse para almacenar el contenido del archivo BFILE.
			DBMS_LOB.LOADFROMFILE(V_FOTOBLOB, ARCHIVO, DBMS_LOB.GETLENGTH(ARCHIVO));
			--cargar el contenido del archivo BFILE (ARCHIVO) en la variable BLOB (V_FOTOBLOB).
			UPDATE B_EMPLEADOS E 
		    SET E.FOTOBLOB=V_FOTOBLOB
			WHERE CURRENT OF C_EMPLEADOS;
			
			DBMS_LOB.FREETEMPORARY(V_FOTOBLOB);
			 --libera el LOB temporal una vez que se ha actualizado la tabla.
			DBMS_LOB.FILECLOSE(ARCHIVO);
		
		END IF;
	END LOOP;
END;
/