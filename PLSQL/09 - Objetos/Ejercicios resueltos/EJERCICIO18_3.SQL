CREATE TABLE VENTAS (
	ID_ARTICULO NUMBER(8),
	CANTIDAD NUMBER(9),
	MONTO NUMBER(9),
	DATOS_CLIENTE T_CLIENTE
);
CREATE OR REPLACE PROCEDURE VENTAS_18_3 (ART NUMBER, CANT NUMBER, CLI VARCHAR2) IS
	AUX NUMBER(5):=0;
	V_PRECIO B_ARTICULOS.PRECIO%TYPE;
	V_TAB T_CLIENTE;
BEGIN 
	SELECT COUNT(*)
	INTO AUX
	FROM B_ARTICULOS
	WHERE ID = ART;
	
	IF AUX = 0 THEN
		RAISE_APPLICATION_ERROR(-20001,'NO EXISTE EL ARTICULO');
	END IF;
	
	SELECT PRECIO
	INTO V_PRECIO
	FROM B_ARTICULOS
	WHERE ID = ART;
	
	AUX:=0;
	SELECT COUNT(*)
	INTO AUX
	FROM TAB_CLIENTE
	WHERE CEDULA_RUC = CLI;
	
	IF AUX = 0 THEN
		RAISE_APPLICATION_ERROR(-20002,'NO EXISTE EL CLIENTE');
	END IF;
	
	V_TAB := T_CLIENTE.ASIGNAR_CLIENTE(CLI);
	INSERT INTO VENTAS VALUES (ART, CANT, V_PRECIO*CANT, V_TAB);
	
END;
/ 

BEGIN
	VENTAS_18_3(123456,1,'429987');
END;
/
